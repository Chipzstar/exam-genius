// -------------------------------------
// WARNING
// THIS FILE IS AUTOGENERATED BY PRISMERGE
// DO NOT MANUALLY EDIT THIS FILE!
// -------------------------------------

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model Course {
  id         Int       @id @unique @default(autoincrement())
  created_at DateTime  @default(now())
  updated_at DateTime  @default(now()) @updatedAt
  course_id  String    @unique
  name       String
  subject    Subject
  code       String?
  user_id    String
  user       User      @relation(fields: [user_id], references: [clerk_id], onDelete: Cascade)
  exam_board ExamBoard
  product_id String?
  year_level Int
  papers     Paper[]

  @@index([user_id])
}

enum Subject {
  maths
  biology
  chemistry
  economics
  physics
  psychology
}

enum ExamBoard {
  edexcel
  aqa
  ocr
}

model Paper {
  id           Int       @id @unique @default(autoincrement())
  created_at   DateTime  @default(now())
  updated_at   DateTime  @default(now()) @updatedAt
  paper_id     String    @unique
  paper_code   String
  paper_number Int       @default(1)
  name         String
  subject      Subject
  exam_board   ExamBoard
  unit_name    String
  user_id      String
  user         User      @relation(fields: [user_id], references: [clerk_id], onDelete: Cascade)
  course_id    String
  course       Course    @relation(fields: [course_id], references: [course_id], onDelete: Cascade)
  content      String    @db.Text
  status       Status    @default(pending)

  @@index([user_id, course_id])
}

enum Status {
  failed
  pending
  success
}

model StripeEvent {
  id               String   @id @unique
  api_version      String?
  data             Json
  request          Json?
  type             String
  object           String
  account          String?
  created          DateTime
  livemode         Boolean
  pending_webhooks Int
}

model User {
  id                         Int                       @id @default(autoincrement())
  clerk_id                   String                    @unique @default("")
  email                      String                    @unique
  full_name                  String
  firstname                  String
  lastname                   String
  year                       String?
  role                       String?
  stripe_customer_id         String?                   @unique
  stripe_subscription_id     String?
  stripe_subscription_status StripeSubscriptionStatus?
  courses                    Course[]
  papers                     Paper[]
}

enum StripeSubscriptionStatus {
  incomplete
  incomplete_expired
  trialing
  active
  past_due
  canceled
  unpaid
  paused
}
